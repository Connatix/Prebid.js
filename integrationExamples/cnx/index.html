<!DOCTYPE html>
<html>
  <head>
    <title>Prebid.js Integration Example</title>
    <!-- <script
            async
            src="https://assets.connatix.com/Elements/f0a86606-5324-4622-ab8e-ec0a1841f0e1/standalone_bundle_v2_video.js"
        ></script> -->
    <script async src="../../build/dev/prebid.js"></script>
    <script>
      var adUnits = [
        {
          code: "1",
          mediaTypes: {
            banner: {
              sizes: [
                [420, 180],
                [300, 250],
              ],
            },
          },
          bids: [
            {
              bidder: "connatix",
              params: {
                placementId: "fa6f2835-91f8-48e3-9bfc-6eed092a31e8",
              },
            },
          ],
        },
        {
          code: "2",
          mediaTypes: {
            video: {
              context: "instream", // 'instream', 'outstream', or 'adpod'
              // playerSize: [640, 480],
              // mimes: ['video/mp4', 'video/webm'],
              // protocols: [1, 2, 3, 4, 5, 6, 7, 8],
              // linearity: 1,
              // maxduration: 30,
              // minduration: 5,
              // playbackmethod: [1, 2]
            },
          },
          renderer: {
            url: "https://cdn.adnxs.com/renderer/video/ANOutstreamVideo.js",
            render: function (bid) {
              ANOutstreamVideo.renderAd({
                targetId: bid.adUnitCode,
                adResponse: bid.adResponse,
              });
            },
          },
          bids: [
            {
              bidder: "connatix",
              params: {
                placementId: "fa6f2835-91f8-48e3-9bfc-6eed092a31e8",
                viewabilityContainerIdentifier: "container",
              },
            },
          ],
        },
        {
          code: "3",
          mediaTypes: {
            video: {
              context: "instream", // 'instream', 'outstream', or 'adpod'
              playerSize: [640, 480],
              mimes: ["video/mp4", "video/webm"],
              protocols: [1, 2, 3, 4, 5, 6, 7, 8],
              linearity: 1,
              maxduration: 30,
              minduration: 5,
              playbackmethod: [1, 2],
            },
          },
          renderer: {
            url: "https://cdn.adnxs.com/renderer/video/ANOutstreamVideo.js",
            render: function (bid) {
              ANOutstreamVideo.renderAd({
                targetId: bid.adUnitCode,
                adResponse: bid.adResponse,
              });
            },
          },
          bids: [
            {
              bidder: "connatix",
              params: {
                placementId: "fa6f2835-91f8-48e3-9bfc-6eed092a31e8",
              },
            },
          ],
        },
      ];
      function initPrebid() {
        var pbjs = window.pbjs || {};
        pbjs.setConfig({
          userSync: {
            userIds: [
              {
                name: "sharedId",
                storage: {
                  type: "cookie",
                  name: "_pubcid",
                  expires: 30,
                },
              },
              {
                name: "connatix",
              },
              {
                name: "merkleId",
                params: {
                  vendor: "idsv2",
                  sv_cid: "5344_04531",
                  sv_pubid: "12562",
                  sv_domain: "accuweather.com",
                  endpoint: "https://id2.sv.rkdms.com/identity/",
                  ssp_ids: ["534404531"],
                },
                storage: {
                  type: "html5",
                  name: "merkleId",
                  expires: 30,
                },
              },
              {
                name: "pubProvidedId",
                params: {
                  eids: [
                    {
                      source: "accuweather.com",
                      uids: [
                        {
                          id: "e158f4c1x668bx42a7x9908x7a4fedb424ff",
                          atype: 1,
                          ext: {
                            stype: "ppuid",
                          },
                        },
                      ],
                    },
                  ],
                },
              },
              {
                name: "33acrossId",
                params: {
                  pid: "0014000000xvF2DAAU",
                },
                storage: {
                  name: "33acrossId",
                  type: "html5",
                  expires: 90,
                  refreshInSeconds: 28800,
                },
              },
              {
                name: "unifiedId",
                params: {
                  partner: "vtlti0n",
                },
              },
            ],
            filterSettings: {
              iframe: {
                bidders: "*", // '*' means all bidders
                filter: "include",
              },
            },
            syncsPerBidder: 3,
            auctionDelay: 5,
          },
          cache: {
            url: "https://prebid.adnxs.com/pbc/v1/cache?uuid=1234",
          },
          ortb2: {
            site: {
              content: {
                id: "some_id",
                episode: "1",
                title: "some title",
                series: "some series",
                season: "s1",
                artist: "John Doe",
                genre: "some genre",
                isrc: "CC-XXX-YY-NNNNN",
                url: "http://foo_url.de",
                cat: ["IAB1-1", "IAB1-2", "IAB2-10"],
                context: "7",
                keywords: "k1,k2",
                live: "0",
              },
            },
          },
        });
        pbjs.que = pbjs.que || [];
        pbjs.que.push(function () {
          pbjs.addAdUnits(adUnits);
          pbjs.requestBids({
            timeout: 90000,
            adUnits: adUnits,
            bidsBackHandler: (bid, timedOut, auctionId) => {
              console.log(bid);
              if (Object.keys(bid).length > 0) {
                const bestBid = pbjs.getHighestCpmBids()[0];
                var iframe = document.createElement("iframe");
                // Set iframe attributes
                iframe.style.width = "100%";
                iframe.style.height = "50%";
                // Add the iframe to the document or a specific container
                document.getElementById("ad_slot").appendChild(iframe);
                // Get the iframe's document
                var doc =
                  iframe.contentDocument || iframe.contentWindow.document;
                // Write the HTML string to the iframe document
                doc.open();
                doc.write(ad);
                doc.close();
              }
            },
          });
        });
      }
    </script>
  </head>
  <body>
    <h1>Prebid.js Integration Example</h1>
    <script>
      // Initialize Prebid.js and request bids
      setTimeout(() => initPrebid(), 1000);
    </script>
    <div id="container" style="width: 1080px; height: 566px">
      <div id="ad_slot" style="width: 1080px; height: 566px"></div>
    </div>
  </body>
</html>
